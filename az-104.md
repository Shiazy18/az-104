# AZ 104 Notes

## Manage Azure identities and governance

in a free Microsoft Entra ID tenant, you can only assign licenses to individual users like User1. Group-based licensing (for Group1 or Group2) requires a paid version of Microsoft Entra ID (such as P1 or P2).

`SSPR` can be directly assigned only to a group of users or to ALL users but not to individual users.

- in order to configure Self-Service Password Reset (SSPR) in Microsoft Entra, a user must have at least the Authentication Policy Administrator role.
- Self-Service Password Reset (SSPR) can be enabled for security groups and Microsoft 365 groups.

`Azure  Entra ID licenses `can be assigned to user accounts directly or to groups, which then assign the licenses to all group members. According to the official documentation, licenses can be assigned to Microsoft 365 groups and security groups, but they must be security-enabled.

The `User Access Administrator` role allows to manage access for other users on that resource, including assigning roles and permissions. This role provides the capability to delegate access without providing permissions to modify the resource itself.

Only users with the Global Administrator or Authentication Administrator roles have the necessary permissions to modify security questions in the SSPR settings.

## Deploy and manage Azure compute resources

To ensure that you can push and pull signed container images in ContReg1, you need to enable content trust. Content trust ensures that the integrity of the images is maintained by verifying that the images are signed and have not been tampered with. This allows only trusted and signed images to be pushed and pulled from the registry.



`Azure Policy` definitions can be assigned at any level in the Azure hierarchy, including the tenant root group, management groups, subscriptions,  resource groups, and individual resource.

`Tenant Root Group` cannot be excluded from policy assignments. Exclusions are applicable to management groups, subscriptions, resource groups, and individual resources only.

`DSC extension` allows you to define a desired state configuration for virtual machines in a scale set. This configuration can include installing and configuring software like NGINX on all virtual machines automatically after deployment.

`Service Tags` simplify network security group (NSG) rules by allowing you to reference a group of IP addresses associated with a specific Azure service.



## Implement and manage storage

Azure Storage accounts support a maximum of 5 stored access policies per container.
Azure Storage accounts support a maximum of 2 immutable blob storage policies per container.

'`azcopy copy`' command is used to upload files from an on-premises folder to an Azure Storage container. Blob storage and File storage are supported by az copy
`az storage blob` copy start is intended for copying blobs within Azure Storage
`azcopy sync` is used to synchronize files between a local folder and a storage container, rather
`az storage blob` copy start-batch is designed for batch copying blobs within Azure Storage,

the net use command relies on the SMB (Server Message Block) protocol, which only supports authentication using the Azure Storage account key for access to Azure File Shares.

when using `customer-managed keys` with Azure Storage, the service supports `RSA keys` for encryption stored in Azure Key Vault.
`AES` is commonly used for encryption
`customer-managed keys` stored in Azure Key Vault, the maximum supported bit length for RSA encryption keys is `4096` bits.

`App Service` backups do not use Backup vaults; they rely on Azure Storage accounts.
`Recovery Services vaults` are used for Azure Backup and Azure Site Recovery, not for App Service backups.

`Azure App Service`, you can exclude specific files or folders from a backup by creating a _backup.filter file in the root directory of the app.
WebJobs are used to run background tasks in Azure App Service,

`Azure Files` provides a fully managed SMB file share that can be mounted by Azure container instances as persistent storage. This is essential for scenarios like running Microsoft SQL Server in a container, where data needs to persist across container restarts. However, it is important to note that volume mounting, including Azure Files, is currently only supported for Linux-based Azure container instances. Therefore, this solution assumes that Image1 is a Linux container image running SQL Server for Linux (which is fully supported).

`Azure's availability zones` are designed to protect against datacenter-level failures, providing high availability by distributing resources across multiple zones within a region.

`Azure Backup` uses block blobs to store backup data, making BlobStorage an appropriate type for this purpose. Additionally, placing backup data in the same region as the resource being backed up minimizes latency and avoids additional costs associated with cross-region data transfers.

`Lifecycle management policies` are supported for block blobs and append blobs in general-purpose v2, premium block blob, and Blob Storage accounts.

only storage accounts configured with `LRS` (Locally Redundant Storage), `GRS` (Geo-Redundant Storage), or `RA-GRS` (Read-Access Geo-Redundant Storage) support moving blob data to the Archive access tier.

`stored access policies` are used in conjunction with Shared Access Signatures (SAS) to manage shared access over time, but they cannot enforce access based on blob index tags.

The `Cool tier` has a minimum retention `period of 30 days`, meaning that if a blob is deleted, overwritten, or moved to another tier before 30 days, an early deletion penalty applies.

The `Archive tier` has a minimum retention period of 180 days.

## Implement and manage virtual networking

`Application Gateway` manages HTTP/S traffic to web applications, not private connectivity between a web app and a VM in a virtual network.
`load balancer` manages traffic distribution but does not enable direct network connectivity between web apps and VMs.

In a `proximity placement group`, all resources are logically grouped to minimize latency by ensuring they are located within the same data center. Proximity placement groups are specific to a region and must be within a single resource group. Furthermore, each proximity placement group is associated with only one Azure Resource Group.

To create a `staging slot `for an Azure App Service plan, it must be in the Standard, Premium, or higher pricing tier. Since staging slots are not available for the Free, Shared, or Basic tiers, the solution here is to scale up Plan1 to a tier that supports deployment slots.

`Azure Container Instances` support only Linux and Windows containers, but for multi-container groups, all containers must be based on the same OS type.

` Azure Bastion `uses HTTPS on port 443 for secure communication from the user's browser to the Azure Bastion host.

`Azure Firewall` can connect to a virtual network within the same region and resource group.

port 53, which is used by the DNS service.

## Monitor and maintain Azure resources

`IP flow verify` allows you to test whether traffic is allowed to or from a virtual machine based on NSG (Network Security Group) rules. It specifically helps in identifying whether a particular port (like 33000) is blocked or allowed, which is essential for troubleshooting connectivity between VMs.

`Azure Monitor Network Insights`  gives you a high-level view of the health and topology of your network resources

`Azure Virtual Network Manager` because it's used for centralized network management and policy enforcement across VNets, not for diagnosing connectivity issues like blocked ports.

when a `peering connection is in a Disconnected state`, you must `delete the existing peering` first in order to modify the address space.

Alert rule can send:

- 12 text messages every hour
- 60 emails every hour

### Azure Network Watcher

`Connection troubleshoot` is specifically designed to validate outbound connectivity from an Azure virtual machine (VM) to an external host. This feature checks the end-to-end connection and identifies if the connection succeeds or fails, providing insights into network latency, packet loss, and the point of failure.

`IP flow verify` checks whether a specific packet is allowed or denied by security rules, but it does not validate the entire outbound connection path.

`Next hop` shows the next hop a packet will take to reach its destination but does not validate the outbound connection itself.

`NSG flow logs` provides a record of traffic through network security groups (NSGs) but does not validate outbound connectivity.

`Traffic Analytics` analyzes traffic patterns and usage but does not validate specific outbound connections.